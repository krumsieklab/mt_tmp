% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mt_pre_confounding_correction_stepwise_aic.R
\name{mt_pre_confounding_correction_stepwise_aic}
\alias{mt_pre_confounding_correction_stepwise_aic}
\title{Confounding correction using stepwise AIC}
\usage{
mt_pre_confounding_correction_stepwise_aic(
  D,
  id_col,
  med_file,
  to_remove = c(),
  n_cores = 1
)
}
\arguments{
\item{D}{SummarizedExperiment object}

\item{id_col}{column name of summarized experiment with sample id}

\item{med_file}{name of file containing medication data}

\item{to_remove}{vector of medication names that should not be corrected for}

\item{n_cores}{number of cores to use in parallelization}
}
\value{
SE with corrected data

$output: returns data.frame with the metabolite, its covars and the fit pval and rsq values
}
\description{
\code{mt_pre_confounding_correction_stepwise_aic} returns the corrected data
}
\details{
each metabolite is corrected by lm with the confounding variables determined by stepwise aic
and residuals are returned in lieu of uncorrected metabolites expressions.
}
\examples{
 \dontrun{#... \%>\% mt_pre_confounding_correction_stepwise_aic(id_col = "RID", med_file = meds,
                         to_remove = c( "Med.Anticholinesterases", "Med.NMDAAntag"), n_cores = 10)
 }


}
\author{
Annalise Schweickart
}
